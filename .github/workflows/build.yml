name: Main

on: push

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Prepare Git
        run: git clone https://github.com/phoenixthrush/blocklist.git; cd blocklist
      - name: Fix LFS sources.txt
        run: rm sources.txt; wget https://media.githubusercontent.com/media/phoenixthrush/blocklist/master/sources.txt
      - name: Build
        run: chmod +x ./dev.sh
      - name: Process
        run: bash ./dev.sh
      - name: Test
        run: du -hs unique.txt
      - name: Release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: ${{ github.ref_name }}
          files: unique.txt
